
#################################################################################################################################################

# Imports
import os
import pyodbc

# Modules
from . import helpers

#################################################################################################################################################

# Get File-Paths
fileDir = os.path.dirname(os.path.abspath(__file__))
iba_clear_sql = os.path.abspath(os.path.join(fileDir, '../sql/iba.clear.sql'))

##########################################################################################################################
#                                                        MAIN CODE                                                       #
##########################################################################################################################

class connect:

    def iba():
        return pyodbc.connect(
            driver='ODBC Driver 17 for SQL Server',
            server=os.getenv('IBA_MSSQL_DSN'),
            uid=os.getenv('IBA_MSSQL_USER'),
            pwd=os.getenv('IBA_MSSQL_PASSWORD')
        )

##########################################################################################################################
#                                                        MAIN CODE                                                       #
##########################################################################################################################

def clear():
    # Connect to Server
    conn = connect.iba()
    # Execute Query
    data = helpers.execute(conn, open(iba_clear_sql).read())
    # Return Data
    return data

##########################################################################################################################
#                                                        MAIN CODE                                                       #
##########################################################################################################################
